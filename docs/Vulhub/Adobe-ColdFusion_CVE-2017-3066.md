# Adobe-ColdFusion 反序列化漏洞

> 漏洞说明

Adobe ColdFusion是美国Adobe公司的一款动态Web服务器产品，其运行的CFML（ColdFusion Markup Language）是针对Web应用的一种程序设计语言。

Adobe ColdFusion中存在java反序列化漏洞。攻击者可利用该漏洞在受影响应用程序的上下文中执行任意代码或造成拒绝服务。



> 前提条件

Adobe ColdFusion (2016 release) Update 3及之前的版本

ColdFusion 11 Update 11及之前的版本

ColdFusion 10 Update 22及之前的版本



> 利用工具

[ColdFusionPwn-0.0.1-SNAPSHOT-all.jar](https://github.com/codewhitesec/ColdFusionPwn/releases/download/0.0.1/ColdFusionPwn-0.0.1-SNAPSHOT-all.jar)

[ysoserial-master-SNAPSHOT.jar](https://jitpack.io/com/github/frohoff/ysoserial/master-SNAPSHOT/ysoserial-master-SNAPSHOT.ja)



> 漏洞复现

环境启动，访问http://192.168.40.77:8500/CFIDE/administrator/index.cfm，输入密码vulhub，成功安装Adobe-ColdFusion

![image-20221218222015451](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218222015451.png)

在Linux环境利用工具生成exp，Windows会报错

![image-20221218223420085](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218223420085.png)

将生成的exp作为数据包body发送给http://192.168.40.77:8500/flex2gateway/amf,修改Content-Type为application/x-amf

选择paste from file

![image-20221218224505671](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218224505671.png)

上传exp

![image-20221218224331815](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218224331815.png)

发送请求包

![image-20221218224538139](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218224538139.png)

由于编码问题，低版本bp(比如burpsuite_pro_v2.1.07)才能成功反弹shell,也可以使用postman方案https://cloud.tencent.com/developer/article/1888968代替

![image-20221218225009425](../img/Adobe-ColdFusion_CVE-2017-3066/image-20221218225009425.png)